#naming convention:
#  function.FEATURE/argument.number, e.g.
#  tex.usedims.1

test <- texr:::test

m <- matrix(1:4, nrow = 2, ncol = 2)
reset_label_count()

# ***TESTS OF tex***

#test the simplest output
test("texmatrix.VALUE.1", tex(m), 
     c("\\begin{table}[]", "\\caption{Matrix: m}", 
       "\\label{tbl:1}", "\\centering", "\\begin{tabular}{rrr}", 
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
   
#test use.dims: accepts FALSE, "row", or "col"
test("tex.usedims.1", tex(m, use.dims = FALSE),
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:2}", 
       "\\centering", "\\begin{tabular}{rr}", "1 & 3 \\\\", "2 & 4 \\\\", 
       "\\end{tabular}", "\\end{table}"))
test("tex.usedims.2", tex(m, use.dims = "row"),
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:3}", 
       "\\centering", "\\begin{tabular}{rrr}", 
       "1 & 1 & 3 \\\\", "2 & 2 & 4 \\\\", 
       "\\end{tabular}", "\\end{table}"))
test("tex.usedims.3", tex(m, use.dims = "col"),
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:4}", 
       "\\centering", "\\begin{tabular}{rr}", "1 & 2 \\\\", "1 & 3 \\\\", 
       "2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))

#test align: check validity and functionality
test("tex.align.1", tex(m, align = "lcr"),
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:5}", 
       "\\centering", "\\begin{tabular}{lcr}",
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
test("tex.align.2", tex(m, align = "R&s"), error = "^Invalid")
test("tex.align.3", tex(m, align = "rrrr"), error = "^You specified")

#test label
test("tex.label.1", tex(m, label = "tbl:mat"), 
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:mat}", 
       "\\centering", "\\begin{tabular}{rrr}", 
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
       
#test digits
# ****NOT YET IMPLEMENTED****

#test caption
test("tex.caption.1", tex(m, caption = "Matrix Output"),
     c("\\begin{table}[]", "\\caption{Matrix Output}", "\\label{tbl:9}", 
       "\\centering", "\\begin{tabular}{rrr}",
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))

#test hline.after: check validity and functionality
test("tex.hlineafter.1", tex(m, hline.after = 0:2),
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:10}", 
       "\\centering", "\\begin{tabular}{rrr}", " & 1 & 2 \\\\", "\\hline", 
       "1 & 1 & 3 \\\\", "\\hline", "2 & 2 & 4 \\\\",
       "\\hline", "\\end{tabular}", "\\end{table}"))
test("tex.hlineafter.2", tex(m, hline.after = 6), error = "^Row ")
test("tex.hlineafter.3", tex(m, hline.after = 5:6), error = "^Rows ")
test("tex.hlineafter.4", tex(m, use.dims = FALSE, hline.after = -1),
     error = "Please use.*col")

#test vline.after: check validity and functionality
test("tex.vlineafter.1", tex(m, vline.after = 0:2), 
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:14}", 
       "\\centering", "\\begin{tabular}{r|r|r|}",
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
test("tex.vlineafter.2", tex(m, vline.after = 6), error = "^Column ")
test("tex.vlineafter.3", tex(m, vline.after = 5:6), error = "^Columns ")
test("tex.vlineafter.4", tex(m, use.dims = FALSE, vline.after = -1),
     error = "Please use.*row")
     
#test na.char
# ****NOT YET IMPLEMENTED****

#test file
ff <- tempfile()
tex(m, file = ff)
test("tex.file.1", readLines(ff), 
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:18}", 
       "\\centering", "\\begin{tabular}{rrr}", 
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
       
#test placement: validity and functionality
test("tex.placement.1", tex(m, placement = "!htbp"),
     c("\\begin{table}[!htbp]", "\\caption{Matrix: m}", "\\label{tbl:17}", 
       "\\centering", "\\begin{tabular}{rrr}",
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
test("tex.placement.2", tex(m, placement = "xxxx"), 
     error = "^Invalid float")
     
# ***TESTS OF reset_label_count, get_label_count***
     
test("resetlabelcount.VALUE.1", reset_label_count(), 0L)
test("resetlabelcount.VALUE.2", tex(m), 
     c("\\begin{table}[]", "\\caption{Matrix: m}", "\\label{tbl:1}", 
       "\\centering", "\\begin{tabular}{rrr}",
       " & 1 & 2 \\\\", "1 & 1 & 3 \\\\", 
       "2 & 2 & 4 \\\\", "\\end{tabular}", "\\end{table}"))
       
test("getlabelcount.VALUE.1", get_label_count(), 1L)
